{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Michael/Documents/programming/React/fresherstrip/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Michael/Documents/programming/React/fresherstrip/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{LOGIN_SUCCESS,LOGIN_FAIL,USER_LOADED_SUCCESS,USER_LOADED_FAIL}from'../actions/types';export var load_user=function load_user(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.getItem('access')){_context.next=14;break;}config={headers:{'Content-Type':'application/json','Authorization':\"JWT \".concat(localStorage.getItem('access')),'Accept':'application/json'}};_context.prev=2;_context.next=5;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/me/\"),config);case 5:res=_context.sent;dispatch({type:USER_LOADED_SUCCESS,payload:res.data});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);dispatch({type:USER_LOADED_FAIL});case 12:_context.next=15;break;case 14:dispatch({type:USER_LOADED_FAIL});case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context2.prev=2;_context2.next=5;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/create/\"),body,config);case 5:res=_context2.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(load_user());_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);dispatch({type:LOGIN_FAIL});case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[2,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Users/Michael/Documents/programming/React/fresherstrip/frontend/src/actions/auth.js"],"names":["axios","LOGIN_SUCCESS","LOGIN_FAIL","USER_LOADED_SUCCESS","USER_LOADED_FAIL","load_user","dispatch","localStorage","getItem","config","headers","get","process","env","REACT_APP_API_URL","res","type","payload","data","login","email","password","body","JSON","stringify","post"],"mappings":"+WAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OACIC,aADJ,CAEIC,UAFJ,CAGIC,mBAHJ,CAIIC,gBAJJ,KAKO,kBALP,CAOA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,kGAAM,iBAAMC,QAAN,qIACvBC,YAAY,CAACC,OAAb,CAAqB,QAArB,CADuB,0BAEjBC,MAFiB,CAER,CACXC,OAAO,CAAE,CACL,eAAgB,kBADX,CAEL,8BAAwBH,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAxB,CAFK,CAGL,SAAU,kBAHL,CADE,CAFQ,uCAWDR,CAAAA,KAAK,CAACW,GAAN,WAAaC,OAAO,CAACC,GAAR,CAAYC,iBAAzB,oBAA6DL,MAA7D,CAXC,QAWbM,GAXa,eAanBT,QAAQ,CAAC,CACLU,IAAI,CAAEb,mBADD,CAELc,OAAO,CAAEF,GAAG,CAACG,IAFR,CAAD,CAAR,CAbmB,+EAkBnBZ,QAAQ,CAAC,CACLU,IAAI,CAAEZ,gBADD,CAAD,CAAR,CAlBmB,uCAwBvBE,QAAQ,CAAC,CACLU,IAAI,CAAEZ,gBADD,CAAD,CAAR,CAxBuB,oEAAN,gEAAlB,CA8BP,MAAO,IAAMe,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,KAAD,CAAQC,QAAR,kGAAqB,kBAAMf,QAAN,0IAChCG,MADgC,CACvB,CACXC,OAAO,CAAE,CACL,eAAgB,kBADX,CADE,CADuB,CAOhCY,IAPgC,CAOzBC,IAAI,CAACC,SAAL,CAAe,CAAEJ,KAAK,CAALA,KAAF,CAASC,QAAQ,CAARA,QAAT,CAAf,CAPyB,yCAUhBrB,CAAAA,KAAK,CAACyB,IAAN,WAAcb,OAAO,CAACC,GAAR,CAAYC,iBAA1B,sBAAgEQ,IAAhE,CAAsEb,MAAtE,CAVgB,QAU5BM,GAV4B,gBAYlCT,QAAQ,CAAC,CACLU,IAAI,CAAEf,aADD,CAELgB,OAAO,CAAEF,GAAG,CAACG,IAFR,CAAD,CAAR,CAKAZ,QAAQ,CAACD,SAAS,EAAV,CAAR,CAjBkC,qFAoBlCC,QAAQ,CAAC,CACLU,IAAI,CAAEd,UADD,CAAD,CAAR,CApBkC,uEAArB,kEAAd","sourcesContent":["import axios from 'axios';\r\nimport{\r\n    LOGIN_SUCCESS,\r\n    LOGIN_FAIL,\r\n    USER_LOADED_SUCCESS,\r\n    USER_LOADED_FAIL\r\n} from '../actions/types';\r\n\r\nexport const load_user = () => async dispatch => {\r\n    if (localStorage.getItem('access')){\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `JWT ${localStorage.getItem('access')}`,\r\n                'Accept': 'application/json'\r\n            }\r\n        };\r\n\r\n        try{\r\n            const res = await axios.get(`${process.env.REACT_APP_API_URL}/auth/users/me/`, config);\r\n            \r\n            dispatch({\r\n                type: USER_LOADED_SUCCESS,\r\n                payload: res.data\r\n            });\r\n        }catch(err){\r\n            dispatch({\r\n                type: USER_LOADED_FAIL\r\n            });\r\n        }\r\n    }\r\n    else{\r\n        dispatch({\r\n            type: USER_LOADED_FAIL\r\n        });\r\n    }\r\n};\r\n\r\nexport const login = (email, password) => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({ email, password});\r\n\r\n    try{\r\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/create/`, body, config);\r\n        \r\n        dispatch({\r\n            type: LOGIN_SUCCESS,\r\n            payload: res.data\r\n        });\r\n        \r\n        dispatch(load_user());\r\n    }\r\n    catch(err){\r\n        dispatch({\r\n            type: LOGIN_FAIL\r\n        });\r\n    }\r\n};"]},"metadata":{},"sourceType":"module"}